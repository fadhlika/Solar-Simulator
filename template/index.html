{{template "head"}}
<body>
    {{template "topbar" }}
    {{template "notification"}}
    {{template "confirm-dialog"}}
    <main id="main">
        <div class="chart-row">
            <div class="chart"><canvas id="tempChart"></canvas></div>
            <div class="chart"><canvas id="lumChart"></canvas></div>
            <div class="chart"><canvas id="voltageChart"></canvas></div>
        </div>
        <div class="data-container" id="data">
            <table class="data-table" id="solardata-table">
                <tr>
                    <th>
                        <i class="fa fa-clock-o" aria-hidden="true"></i>
                        <span>Date</span>
                    </th>
                    <th>
                        <i class="fa fa-bolt" aria-hidden="true"></i>
                        <span>Voltage</span>
                    </th> 
                    <th>
                        <i class="fa fa-bolt" aria-hidden="true"></i>
                        <span>Current</span>
                    </th>
                    <th>
                        <i class="fa fa-thermometer-quarter" aria-hidden="true"></i>
                        <span>Temp 1</span>
                    </th>
                    <th>
                        <i class="fa fa-thermometer-quarter" aria-hidden="true"></i>
                        <span>Temp 2</span>    
                    </th> 
                    <th>
                        <i class="fa fa-lightbulb-o" aria-hidden="true"></i>
                        <span>Lum 1</span>
                    </th>
                    <th>
                        <i class="fa fa-lightbulb-o" aria-hidden="true"></i>
                        <span>Lum 2</span>
                    </th>
                </tr>
                {{ $data := .data }}
                {{ range $k, $v := .keys }}
                    <tr>
                        <td>{{ (index $data $v).Created.Format "2006-01-02 15:04:05" }}</td>
                        <td>{{ (index $data $v).Voltage }}</td>
                        <td>{{ (index $data $v).Current }}</td>
                        <td>{{ (index $data $v).Temp1 }}</td>
                        <td>{{ (index $data $v).Temp2 }}</td>
                        <td>{{ (index $data $v).Lum1 }}</td>
                        <td>{{ (index $data $v).Lum2 }}</td>
                    </tr>
                {{ end }}
            </table>
        </div>
        <div class="data-container" id="debug">
            <table class="data-table" id="solardebug-table">
                <tr>
                    <th>
                        <i class="fa fa-clock-o" aria-hidden="true"></i>
                        <span>Date</span>
                    </th>
                    <th>
                        <i class="fa fa-file-text" aria-hidden="true"></i>
                        <span>Message</span>
                    </th>
                </tr>
                {{ $d := .debug }}
                {{ range $i, $n := .debugkeys }}
                    <tr>
                        <td>{{ (index $d $n).Created.Format "2006-01-02 15:04:05" }}</td>
                        <td>{{ (index $d $n).Message }}</td>
                    </tr>
                {{ end }}
            </table>
        </div>
    </main>
    <script>
         var tempChart = new Chart(document.getElementById("tempChart"), {
        type: 'line',
        data: {
            datasets: [{
                pointRadius: 0,
                backgroundColor: 'rgb(153, 153, 153)',
                borderColor: 'rgb(153, 153, 153)',
                label: 'Temperature1',
                data: [
                {{ $data := .data }}
                {{ range $k, $v := .keys }}
                        {
                            x: {{ (index $data $v).Created }},
                            y: {{ (index $data $v).Temp1 }}
                        }, 
                {{ end }}
                ],
                fill: false
            },
            {
                pointRadius: 0,
                backgroundColor: 'rgb(58, 58, 58)',
                borderColor: 'rgb(58, 58, 58)',
                label: 'Temperature2',
                data: [
                {{ $data := .data }}
                {{ range $k, $v := .keys }}
                        {
                            x: {{ (index $data $v).Created }},
                            y: {{ (index $data $v).Temp2 }}
                        }, 
                {{ end }}
                ],
                fill: false
            }]
        },
        options: {
            responsive: true,
            scales: {
                xAxes: [{
                    type: 'time',
                    time: {
                        unit: 'millisecond'
                    }
                }],
                yAxes: [{
                    ticks: {
                        beginAtZero:true
                    }
                }]
            }
        }
    });
    var lumChart = new Chart(document.getElementById("lumChart"), {
        type: 'line',
        data: {
            datasets: [{
                pointRadius: 0,
                backgroundColor: 'rgb(153, 153, 153)',
                borderColor: 'rgb(153, 153, 153)',
                label: 'Luminance1',
                data: [
                {{ $data := .data }}
                {{ range $k, $v := .keys }}
                        {
                            x: {{ (index $data $v).Created }},
                            y: {{ (index $data $v).Lum1 }}
                        }, 
                {{ end }}
                ],
                fill: false
            },
            {
                pointRadius: 0,
                backgroundColor: 'rgb(58, 58, 58)',
                borderColor: 'rgb(58, 58, 58)',
                label: 'Luminance2',
                data: [
                {{ $data := .data }}
                {{ range $k, $v := .keys }}
                        {
                            x: {{ (index $data $v).Created }},
                            y: {{ (index $data $v).Lum2 }}
                        }, 
                {{ end }}
                ],
                fill: false
            }]
        },
        options: {
            responsive: true,
            scales: {
                xAxes: [{
                    type: 'time',
                    time: {
                        unit: 'millisecond'
                    }
                }],
                yAxes: [{
                    ticks: {
                        beginAtZero:true
                    }
                }]
            }
        }
    });
    var voltageChart = new Chart(document.getElementById("voltageChart"), {
        type: 'line',
        data: {
            datasets: [{
                pointRadius: 0,
                backgroundColor: 'rgb(153, 153, 153)',
                borderColor: 'rgb(153, 153, 153)',
                label: 'Voltage',
                data: [
                {{ $data := .data }}
                {{ range $k, $v := .keys }}
                        {
                            x: {{ (index $data $v).Created }},
                            y: {{ (index $data $v).Voltage }}
                        }, 
                {{ end }}
                ],
                fill: false
            },
            {
                pointRadius: 0,
                backgroundColor: 'rgb(58, 58, 58)',
                borderColor: 'rgb(58, 58, 58)',
                label: 'Current',
                data: [
                {{ $data := .data }}
                {{ range $k, $v := .keys }}
                        {
                            x: {{ (index $data $v).Created }},
                            y: {{ (index $data $v).Current }}
                        }, 
                {{ end }}
                ],
                fill: false
            }]
        },
        options: {
            responsive: true,
            scales: {
                xAxes: [{
                    type: 'time',
                    time: {
                        unit: 'millisecond'
                    }
                }],
                yAxes: [{
                    ticks: {
                        beginAtZero:true
                    }
                }]
            }
        }
    });
    </script>
</body>